{% extends 'AppBundle::layout.html.twig' %}

{% block content %}
    <div class="container">
        <div>
            <div style="padding: 20px">
                <table class="basket" cellspacing="0">
                    <tr>
                        <th>Округ</th>
                        <th>Адрес</th>
                        <th>Сторона</th>
                        <th>GRP</th>
                        <th>OTS</th>
                        <th class="width-30"></th>
                        <th class="tdmonth">Янв</th>
                        <th class="tdmonth">Фев</th>
                        <th class="tdmonth">Мар</th>
                        <th class="tdmonth">Апр</th>
                        <th class="tdmonth">Май</th>
                        <th class="tdmonth">Июн</th>
                        <th class="tdmonth">Июл</th>
                        <th class="tdmonth">Авг</th>
                        <th class="tdmonth">Сен</th>
                        <th class="tdmonth">Окт</th>
                        <th class="tdmonth">Ноя</th>
                        <th class="tdmonth">Дек</th>
                    </tr>
                    {% for k,b in lists %}
                    <tr>
                        <td>{{ b.area }}</td>
                        <td>{{ b.adrs }}</td>
                        <td>{{ b.side }}</td>
                        <td>{{ b.grp }}</td>
                        <td>{{ b.ots }}</td>
                        <td class="width-30"></td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="1" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="1" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="2" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="2" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="3" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="3" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="4" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="4" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="5" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="5" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="6" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="6" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="7" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="7" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="8" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="8" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="9" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="9" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="10" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="10" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="11" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="12" data-year="2015">
                        </td>
                        <td class="month">
                            <img src="{{ asset('bundles/app/icon/ok.png') }}" class="icon24 ok" data-id="{{ k }}" data-month="12" data-year="2015">
                            <img src="{{ asset('bundles/app/icon/cancel.png') }}" class="icon24 cancel" style="display: none" data-id="{{ k }}" data-month="12" data-year="2015">
                        </td>
                    </tr>
                    {% endfor %}
                    <tr>
                        <td colspan="12"></td>
                        <td colspan="6">
                            <b>ИТОГО:&nbsp;&nbsp;&nbsp;&nbsp;</b><span id="priceCount">0 р.</span>
                        </td>
                    </tr>
                </table>
                <a href="{{ path('basket_save') }}"><button>Сохранить</button></a>
                <a href="{{ path('basket_clear') }}"><button>Очистить</button></a>
            </div>
        </div>

    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $(document).ready(function () {
            $('.ok').click(function () {
                var td = $(this).parent();
                td.children('.cancel').css('display','inline');
                td.children('.ok').css('display','none');
                td.addClass('active');

                var id = $(this).attr('data-id');
                var month = $(this).attr('data-month');
                var year = $(this).attr('data-year');
                $.ajax({
                    type: "POST",
                    url: Routing.generate('basket_set_month', {'itemId' : id, 'month' : month, 'year' : year }),
                    success: function (data) {
                        console.log(data);
                        $('#priceCount').html(data.price+' р.');
                    }
                });
            });
            $('.cancel').click(function () {
                var td = $(this).parent();
                td.children('.cancel').css('display','none');
                td.children('.ok').css('display','inline');
                td.removeClass('active');
                var id = $(this).attr('data-id');
                var month = $(this).attr('data-month');
                var year = $(this).attr('data-year');
                $.ajax({
                    type: "POST",
                    url: Routing.generate('basket_set_month', {'itemId' : id, 'month' : month, 'year' : year }),
                    success: function (data) {
                        $('#priceCount').html(data.price+' р.');
                    }
                });
            });
        });
    </script>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .container{
            min-width: 800px;
            max-width: 1200px;
            margin: 0 auto;
        }
        #priceCount{
            font-size: 16px;
            font-weight: bold;
        }
    </style>
{% endblock %}